@using Microsoft.AspNetCore.Identity
@using Microsoft.AspNetCore.Mvc.TagHelpers
@model IEnumerable<Order>
 @inject UserManager<RegisterApp> _userManager;
@* @{ *@
@*     ViewBag.Title = "title"; *@
@*     Layout = "_Layout"; *@
@* } *@


@* @{ *@
@*     ViewData["Title"] = "Index"; *@
@* } *@


<div class="container p-3">
    <div class="row pt-4">
        <div class="col-6">
            <h2 class="text-primary">Available Orders</h2>
        </div>
        <div class="col-6 text-end">
            <a asp-controller="Home" asp-action="CreateOrderInSeparatedPage" class="btn btn-primary">
                <i class="bi bi-plus-circle"></i> &nbsp; Create New Order
            </a>
        </div>
    </div>
    <br/><br/>
    <div class="container">
        <table class="table table-bordered table-striped" style="width:100%">
            <thead class="text-center">
            <tr>
                <th scope="col">
                    Id
                </th>
                <th scope="col">
                    Type
                </th>
                <th scope="col">
                    Recepient
                </th>
                <th scope="col">
                    pickUp Location
                </th>
                <th scope="col">
                    dropOff location
                </th>
                <th scope="col">comments</th>
            @if (User.IsInRole("Admin")){
                
                       <th scope="col">Client Username</th>
                   
               }
            </tr>
            </thead>
            <tbody>

       @foreach (var obj in Model)
       {
           <tr>
               <td>
                   @obj.Id
               </td>
               <td>
                   @obj.TypeOfCategories
               </td>
               <td>@obj.NameOfRecipient</td>
               <td>@obj.PickUpLocation</td>
               <td>@obj.DropOffLocation</td>
               <td>@obj.Comments</td>
               @* <td>@obj.Price</td> *@
              
                @if (User.IsInRole("Admin")){
               
               var user = await _userManager.FindByIdAsync(obj.RegisterAppId);
                   if (user != null)
                   {
                       <td>@user.UserName</td>
                   }
               }
               
               <td>
                   <div class="w-75 btn-group" role="group">
                       <a asp-controller="Home" method="post" asp-action="EditOrder" asp-route-id="@obj.Id"
                          class="btn btn-primary m-2">
                           <i class="bi bi-pencil-square"></i>
                       </a>
                   </div>
               </td>
               <td>
                   <div class="w-75 btn-group" role="group">
                       <a asp-controller="Home" method="post" asp-action="DeleteOrder" asp-route-id="@obj.Id"
                          class="btn btn-danger m-2">
                           <i class="bi bi-trash"></i>
                       </a>
                   </div>
               </td>
           </tr>
       }


            </tbody>

        </table>
    </div>
</div>